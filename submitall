if [ "$1" = "" ]; then
    funcfile=/dev/null
elif [  -f "$1" ]; then
    funcfile=$1
else
    funcfile=/tmp/$1
    echo $1 > $funcfile
fi
export TMPDIR=$(python -c 'import tempfile; print(tempfile.mkdtemp())')
python -m fdrsp.gen_findif_all XXQUADRU YYQUADRU ZZQUADRU YDIPLEN $funcfile
echo "HF" > hf_availfun
cat $funcfile >> hf_availfun

#make

for f in $TMPDIR/*.py; do
python -m pytest -v $f 2>&1 | tee $(dirname $f)/$(basename $f .py).log
done

python -m fdrsp.makehtml $TMPDIR/*.log
cp -r dist $TMPDIR

tar -C $TMPDIR -caf test_findif.tgz .


echo
echo "For an overview of results open file://$PWD/test_findif.html in your browser"
echo "Results, output and logfiles are saved in compressed archive test_findif.tgz"
